"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[978],{2138:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"auto-generated-clients","title":"Auto-Generated Clients","description":"Serve it and call it","source":"@site/docs/auto-generated-clients.md","sourceDirName":".","slug":"/auto-generated-clients","permalink":"/docs/auto-generated-clients","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Pipelines","permalink":"/docs/pipelines"},"next":{"title":"File organization","permalink":"/docs/file-organization"}}');var a=t(6070),r=t(5658);const i={sidebar_position:3},l="Auto-Generated Clients",o={},c=[{value:"Serve it and call it",id:"serve-it-and-call-it",level:2},{value:"Handling results",id:"handling-results",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"auto-generated-clients",children:"Auto-Generated Clients"})}),"\n",(0,a.jsx)(n.h2,{id:"serve-it-and-call-it",children:"Serve it and call it"}),"\n",(0,a.jsxs)(n.p,{children:["When creating an endpoint with ",(0,a.jsx)(n.code,{children:"createSchematizedEndpointFactory"}),", you get an object which you can use in two ways:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"pass it to a server to serve the endpoint"}),"\n",(0,a.jsx)(n.li,{children:"call it to fetch the endpoint"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Create an endpoint:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-TypeScript",children:"const createUser = app.createEndpoint(...);\n"})}),"\n",(0,a.jsx)(n.p,{children:"Serve it:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-TypeScript",children:"const serve = createServer();\nserve(createUser);\n"})}),"\n",(0,a.jsx)(n.p,{children:"Call it:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-TypeScript",children:"createUser(...);\n"})}),"\n",(0,a.jsxs)(n.p,{children:["The options you pass to the client (in this case, ",(0,a.jsx)(n.code,{children:"getUser"}),") are determined by the zod schemas you used to create the endpoint."]}),"\n",(0,a.jsx)(n.p,{children:"Note that you'll have to configure the base url that shall be used when calling the client. You might also want to pass an authorize header that shall be passed along the fetch call. You do that on the endpoint factory:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-TypeScript",children:'app.setGlobalClientParams({\n  baseUrl: process.env.BASE_URL ?? "http://0.0.0.0:3000",\n  authorize: btoa("some authorization"),\n})\n'})}),"\n",(0,a.jsx)(n.h2,{id:"handling-results",children:"Handling results"}),"\n",(0,a.jsx)(n.p,{children:"When using a client function we expect to get a successful response most of the time. We can use the following syntax to express that we expect a specific status code. The client will throw an error in any other case:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-TypeScript",children:"const user = await createUser(null as any).ok(200)\n"})}),"\n",(0,a.jsx)(n.p,{children:"We might have scenarios where we want to handle the results more throroughly. We can use this syntax:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-TypeScript",children:'createUser(null as any)\n  .all()\n  .then((result) => {\n    switch (result.type) {\n      case "ok": {\n        switch (result.value.statusCode) {\n          case 200: {\n            ...\n          }\n          case 409: {\n            ...\n          }\n          case 400: {\n            ...\n          }\n          case 401: {\n            ...\n          }\n        }\n      }\n      case "error": {\n        ...\n      }\n    }\n  });\n'})}),"\n",(0,a.jsxs)(n.p,{children:["Note that the value of ",(0,a.jsx)(n.code,{children:"result.value.statusCode"})," depends both on the definition of your endpoint as well as the underlying pipeline. For example, if you used a pipeline that did not include the ",(0,a.jsx)(n.code,{children:"authenticate()"})," middleware, you wouldn't have to handle the ",(0,a.jsx)(n.code,{children:"401"})," here. Instead, you would get a compiler error."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},5658:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>l});var s=t(758);const a={},r=s.createContext(a);function i(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);