"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[329],{2576:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"file-organization","title":"File organization","description":"In kinekt, you\'re free in how you organize your endpoint code. Note that there are no mutable app or router objects that you have to awkwardly pass around. There\'s no controller classes to wrap around your endpoints. Instead, you typically have an endpoint factory from which you forge your endpoints, which ultimately are just async functions. The individual endpoints can then be imported into and served from a single file.","source":"@site/docs/file-organization.md","sourceDirName":".","slug":"/file-organization","permalink":"/docs/file-organization","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"Auto-Generated Clients","permalink":"/docs/auto-generated-clients"},"next":{"title":"Benchmarks","permalink":"/docs/benchmarks"}}');var r=t(6070),i=t(5658);const s={sidebar_position:4},a="File organization",c={},d=[];function l(e){const n={a:"a",code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"file-organization",children:"File organization"})}),"\n",(0,r.jsxs)(n.p,{children:["In kinekt, you're free in how you organize your endpoint code. Note that there are no mutable ",(0,r.jsx)(n.code,{children:"app"})," or ",(0,r.jsx)(n.code,{children:"router"})," objects that you have to awkwardly pass around. There's no controller classes to wrap around your endpoints. Instead, you typically have an endpoint factory from which you forge your endpoints, which ultimately are just async functions. The individual endpoints can then be imported into and served from a single file."]}),"\n",(0,r.jsx)(n.p,{children:'The recommended approach is to create a separate file per endpoint. You will most likely be writing code to interact with a DB. Such code belongs into the same file, together with the endpoint declaration. With this approach, you achieve a good separation of concerns, where a single usecase (for example, "Create User") is self-contained in a file. If you have shared DB code (or any other kind of helper functions), extract them as needed.'}),"\n",(0,r.jsxs)(n.p,{children:['A full example of "Create User" could look something like this (taken from ',(0,r.jsx)(n.a,{href:"https://github.com/simplicity/try-kinekt-with-node",children:"here"}),"):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-TypeScript",metastring:'title="./createUser.ts"',children:'import { z } from "zod";\nimport { db } from "../../../db/db";\nimport { users } from "../../../db/schema";\nimport { pipeline } from "../../pipeline";\n\ntype User = typeof users.$inferInsert;\n\nasync function insertUser(user: User) {\n  return db\n    .insert(users)\n    .values(user)\n    .returning()\n    .then((result) => result.at(0)!)\n    .catch(() => null);\n}\n\nexport const createUser = pipeline.createEndpoint(\n  "POST /users",\n\n  {\n    body: z.object({ name: z.string(), email: z.string() }),\n    response: {\n      200: z.custom<User>(),\n      409: z.custom<{ message: string }>(),\n    },\n  },\n\n  async ({ body }) => {\n    const user = await insertUser(body);\n\n    if (user === null) {\n      return {\n        statusCode: 409,\n        body: { message: `User with email \'${body.email}\' already exists.` },\n      };\n    }\n\n    return {\n      statusCode: 200,\n      body: user,\n    };\n  }\n);\n'})})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},5658:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>a});var o=t(758);const r={},i=o.createContext(r);function s(e){const n=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);